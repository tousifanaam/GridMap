import numpy as np
from time import sleep
import sys
from typing import List, Tuple, Iterable


class NotPlottableError(Exception):
    pass
class NotMergeableError(Exception):
    pass


class GridMap:
    BASE_DICT = {
            '0':
                    (14, 8, (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (3, 5), (3, 6), (4, 1), (4, 2), (4, 5), (4, 6), (5, 1), (5, 2), (5, 5), (5, 6), (6, 1), (6, 2), (6, 5), (6, 6), (7, 1), (7, 2), (7, 5), (7, 6), (8, 1), (8, 2), (8, 5), (8, 6), (9, 1), (9, 2), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 2), (12, 3), (12, 4), (12, 5)),
            '1':
                    (14, 8, (1, 3), (1, 4), (2, 2), (2, 3), (2, 4), (3, 1), (3, 2), (3, 3), (3, 4), (4, 1), (4, 3), (4, 4), (5, 3), (5, 4), (6, 3), (6, 4), (7, 3), (7, 4), (8, 3), (8, 4), (9, 3), (9, 4), (10, 3), (10, 4), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6)),
            '2':
                    (14, 8, (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (3, 5), (3, 6), (4, 5), (4, 6), (5, 5), (5, 6), (6, 4), (6, 5), (7, 3), (7, 4), (7, 5), (8, 2), (8, 3), (8, 4), (9, 1), (9, 2), (9, 3), (10, 1), (10, 2), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6)),
            '3':
                    (14, 8, (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (3, 5), (3, 6), (4, 1), (4, 2), (4, 5), (4, 6), (5, 5), (5, 6), (6, 5), (6, 6), (7, 4), (7, 5), (8, 5), (8, 6), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 2), (12, 3), (12, 4), (12, 5)),
            '4':
                    (14, 8, (1, 6), (2, 5), (2, 6), (3, 4), (3, 5), (3, 6), (4, 3), (4, 4), (4, 5), (4, 6), (5, 2), (5, 3), (5, 5), (5, 6), (6, 1), (6, 2), (6, 5), (6, 6), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 1), (8, 2), (8, 3), (8, 4), (8, 5), (8, 6), (9, 5), (9, 6), (10, 5), (10, 6), (11, 5), (11, 6), (12, 5), (12, 6)),
            '5':
                    (14, 8, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 5), (8, 6), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6)),
            '6':
                    (14, 8, (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 1), (8, 2), (8, 5), (8, 6), (9, 1), (9, 2), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 2), (12, 3), (12, 4), (12, 5)),
            '7':
                    (14, 8, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 5), (3, 6), (4, 5), (4, 6), (5, 4), (5, 5), (5, 6), (6, 3), (6, 4), (6, 5), (7, 3), (7, 4), (8, 3), (8, 4), (9, 3), (9, 4), (10, 3), (10, 4), (11, 3), (11, 4), (12, 3), (12, 4)),
            '8':
                    (14, 8, (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (3, 5), (3, 6), (4, 1), (4, 2), (4, 5), (4, 6), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5), (5, 6), (6, 2), (6, 3), (6, 4), (6, 5), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 1), (8, 2), (8, 3), (8, 4), (8, 5), (8, 6), (9, 1), (9, 2), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 2), (12, 3), (12, 4), (12, 5)),
            '9':
                    (14, 8, (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (3, 5), (3, 6), (4, 1), (4, 2), (4, 5), (4, 6), (5, 1), (5, 2), (5, 5), (5, 6), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 5), (8, 6), (9, 5), (9, 6), (10, 1), (10, 5), (10, 6), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 2), (12, 3), (12, 4), (12, 5)),
            ' ':
                    (14, 8),
            '.':
                    (14, 5, (9, 1), (9, 2), (9, 3), (10, 1), (10, 2), (10, 3), (11, 1), (11, 2), (11, 3), (12, 1), (12, 2), (12, 3)),
            ',':
                    (14, 5, (7, 1), (7, 2), (7, 3), (8, 1), (8, 2), (8, 3), (9, 1), (9, 2), (9, 3), (10, 2), (10, 3), (11, 2), (11, 3), (12, 1), (12, 2)),
            ':':
                    (14, 5, (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2)),
            '\'':
                    (14, 5, (1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3), (3, 1), (3, 2), (3, 3), (4, 2), (4, 3), (5, 2), (5, 3), (6, 1), (6, 2)),
            ';':
                    (14, 5, (3, 1), (3, 2), (3, 3), (4, 1), (4, 2), (4, 3), (5, 1), (5, 2), (5, 3), (7, 1), (7, 2), (7, 3), (8, 1), (8, 2), (8, 3), (9, 1), (9, 2), (9, 3), (10, 2), (10, 3), (11, 2), (11, 3), (12, 1), (12, 2)),
            '(':
                    (14, 5, (1, 3), (1, 4), (2, 2), (2, 3), (2, 4), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (7, 1), (7, 2), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2), (11, 2), (11, 3), (11, 4), (12, 3), (12, 4)),
            ')':
                    (14, 5, (1, 1), (1, 0), (2, 2), (2, 1), (2, 0), (3, 3), (3, 2), (4, 3), (4, 2), (5, 3), (5, 2), (6, 3), (6, 2), (7, 3), (7, 2), (8, 3), (8, 2), (9, 3), (9, 2), (10, 3), (10, 2), (11, 2), (11, 1), (11, 0), (12, 1), (12, 0)),
            '=':
                    (14, 5, (4, 0), (4, 1), (4, 2), (4, 3), (4, 4), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (8, 0), (8, 1), (8, 2), (8, 3), (8, 4), (9, 0), (9, 1), (9, 2), (9, 3), (9, 4)),
            'A':
                    (14, 10, (1, 4), (1, 5), (2, 3), (2, 4), (2, 5), (2, 6), (3, 2), (3, 3), (3, 4), (3, 5), (3, 6), (3, 7), (4, 2), (4, 3), (4, 6), (4, 7), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (8, 1), (8, 2), (8, 3), (8, 4), (8, 5), (8, 6), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'B':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6)),
            'C':
                    (14, 10, (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (7, 1), (7, 2), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7), (12, 8)),
            'D':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (3, 1), (3, 2), (3, 5), (3, 6), (3, 7), (4, 1), (4, 2), (4, 6), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 7), (7, 8), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 6), (9, 7), (9, 8), (10, 1), (10, 2), (10, 5), (10, 6), (10, 7), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5)),
            'E':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7), (12, 8)),
            'F':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2), (11, 1), (11, 2), (12, 1), (12, 2)),
            'G':
                    (14, 10, (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (7, 1), (7, 2), (7, 5), (7, 6), (7, 7), (7, 8), (8, 1), (8, 2), (8, 5), (8, 6), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7)),
            'H':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (6, 8), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'I':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 4), (3, 5), (4, 4), (4, 5), (5, 4), (5, 5), (6, 4), (6, 5), (7, 4), (7, 5), (8, 4), (8, 5), (9, 4), (9, 5), (10, 4), (10, 5), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7), (12, 8)),
            'J':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 7), (3, 8), (4, 7), (4, 8), (5, 7), (5, 8), (6, 7), (6, 8), (7, 7), (7, 8), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7)),
            'K':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (3, 5), (3, 6), (3, 7), (4, 1), (4, 2), (4, 4), (4, 5), (4, 6), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5), (6, 1), (6, 2), (6, 3), (6, 4), (7, 1), (7, 2), (7, 3), (7, 4), (8, 1), (8, 2), (8, 3), (8, 4), (8, 5), (9, 1), (9, 2), (9, 4), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (10, 7), (11, 1), (11, 2), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'L':
                    (14, 10, (1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (7, 1), (7, 2), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7), (12, 8)),
            'M':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (3, 3), (3, 6), (3, 7), (3, 8), (4, 1), (4, 2), (4, 3), (4, 4), (4, 5), (4, 6), (4, 7), (4, 8), (5, 1), (5, 2), (5, 4), (5, 5), (5, 7), (5, 8), (6, 1), (6, 2), (6, 4), (6, 5), (6, 7), (6, 8), (7, 1), (7, 2), (7, 7), (7, 8), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'N':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 7), (2, 8), (3, 1), (3, 2), (3, 3), (3, 7), (3, 8), (4, 1), (4, 2), (4, 3), (4, 4), (4, 7), (4, 8), (5, 1), (5, 2), (5, 3), (5, 4), (5, 7), (5, 8), (6, 1), (6, 2), (6, 4), (6, 5), (6, 7), (6, 8), (7, 1), (7, 2), (7, 4), (7, 5), (7, 7), (7, 8), (8, 1), (8, 2), (8, 5), (8, 6), (8, 7), (8, 8), (9, 1), (9, 2), (9, 5), (9, 6), (9, 7), (9, 8), (10, 1), (10, 2), (10, 6), (10, 7), (10, 8), (11, 1), (11, 2), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'O':
                    (14, 10, (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 7), (7, 8), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7)),
            'P':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (6, 8), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (8, 1), (8, 2), (9, 1), (9, 2), (10, 1), (10, 2), (11, 1), (11, 2), (12, 1), (12, 2)),
            'Q':
                    (14, 10, (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 7), (7, 8), (8, 1), (8, 2), (8, 4), (8, 5), (8, 7), (8, 8), (9, 1), (9, 2), (9, 4), (9, 5), (9, 6), (9, 8), (10, 1), (10, 2), (10, 5), (10, 6), (10, 7), (11, 1), (11, 2), (11, 3), (11, 4), (11, 6), (11, 7), (11, 8), (12, 2), (12, 3), (12, 4), (12, 5), (12, 7), (12, 8)),
            'R':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (6, 8), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (8, 1), (8, 2), (8, 3), (8, 4), (8, 5), (9, 1), (9, 2), (9, 4), (9, 5), (9, 6), (10, 1), (10, 2), (10, 5), (10, 6), (10, 7), (11, 1), (11, 2), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'S':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 1), (3, 2), (4, 1), (4, 2), (5, 1), (5, 2), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (6, 8), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (8, 7), (8, 8), (9, 7), (9, 8), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7), (12, 8)),
            'T':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 4), (3, 5), (4, 4), (4, 5), (5, 4), (5, 5), (6, 4), (6, 5), (7, 4), (7, 5), (8, 4), (8, 5), (9, 4), (9, 5), (10, 4), (10, 5), (11, 4), (11, 5), (12, 4), (12, 5)),
            'U':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 7), (7, 8), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 7), (9, 8), (10, 1), (10, 2), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7)),
            'V':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 7), (7, 8), (8, 1), (8, 2), (8, 7), (8, 8), (9, 1), (9, 2), (9, 3), (9, 6), (9, 7), (9, 8), (10, 2), (10, 3), (10, 4), (10, 5), (10, 6), (10, 7), (11, 3), (11, 4), (11, 5), (11, 6), (12, 4), (12, 5)),
            'W':
                    (14, 10, (1, 1), (1, 2), (1, 7), (1, 8), (2, 1), (2, 2), (2, 7), (2, 8), (3, 1), (3, 2), (3, 7), (3, 8), (4, 1), (4, 2), (4, 7), (4, 8), (5, 1), (5, 2), (5, 7), (5, 8), (6, 1), (6, 2), (6, 7), (6, 8), (7, 1), (7, 2), (7, 4), (7, 5), (7, 7), (7, 8), (8, 1), (8, 2), (8, 4), (8, 5), (8, 7), (8, 8), (9, 1), (9, 2), (9, 3), (9, 4), (9, 5), (9, 6), (9, 7), (9, 8), (10, 1), (10, 2), (10, 3), (10, 6), (10, 7), (10, 8), (11, 1), (11, 2), (11, 3), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 7), (12, 8)),
            'X':
                    (14, 10, (1, 1), (1, 8), (2, 1), (2, 2), (2, 7), (2, 8), (3, 1), (3, 2), (3, 3), (3, 6), (3, 7), (3, 8), (4, 2), (4, 3), (4, 4), (4, 5), (4, 6), (4, 7), (5, 3), (5, 4), (5, 5), (5, 6), (6, 4), (6, 5), (7, 4), (7, 5), (8, 3), (8, 4), (8, 5), (8, 6), (9, 2), (9, 3), (9, 4), (9, 5), (9, 6), (9, 7), (10, 1), (10, 2), (10, 3), (10, 6), (10, 7), (10, 8), (11, 1), (11, 2), (11, 7), (11, 8), (12, 1), (12, 8)),
            'Y':
                    (14, 10, (1, 1), (1, 8), (2, 1), (2, 2), (2, 7), (2, 8), (3, 1), (3, 2), (3, 3), (3, 6), (3, 7), (3, 8), (4, 2), (4, 3), (4, 4), (4, 5), (4, 6), (4, 7), (5, 3), (5, 4), (5, 5), (5, 6), (6, 4), (6, 5), (7, 4), (7, 5), (8, 4), (8, 5), (9, 4), (9, 5), (10, 4), (10, 5), (11, 4), (11, 5), (12, 4), (12, 5)),
            'Z':
                    (14, 10, (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (3, 7), (3, 8), (4, 7), (4, 8), (5, 6), (5, 7), (6, 5), (6, 6), (7, 4), (7, 5), (8, 3), (8, 4), (9, 2), (9, 3), (10, 1), (10, 2), (11, 1), (11, 2), (11, 3), (11, 4), (11, 5), (11, 6), (11, 7), (11, 8), (12, 1), (12, 2), (12, 3), (12, 4), (12, 5), (12, 6), (12, 7), (12, 8)),
    }

    SQR_CHARS = ["■", "⬛"]

    def __init__(self, r: int, c: int, *plots: Tuple[int, int], char: str = "■"):
        self.r, self.c = r, c
        self.char = char
        self._grid = np.zeros((r, c), dtype=bool)
        for y, x in plots:
            self.add_plot(y, x)

    def shape(self):
        return (self.r, self.c)

    @property
    def plots(self) -> List[Tuple[int, int]]:
        return list(zip(*np.where(self._grid)))

    @plots.setter
    def plots(self, pts: Iterable[Tuple[int, int]]):
        self._grid[:] = False
        for y, x in pts:
            if 0 <= y < self.r and 0 <= x < self.c:
                self._grid[y, x] = True
            else:
                raise NotPlottableError(f"Can't plot ({y},{x}) in {self.r}x{self.c}")

    def add_plot(self, y: int, x: int):
        if 0 <= y < self.r and 0 <= x < self.c:
            self._grid[y, x] = True
        else:
            raise NotPlottableError(f"Invalid ({y},{x})")

    def __str__(self):
        return "\n".join(
            "".join(self.char if self._grid[y, x] else " " for x in range(self.c))
            for y in range(self.r)
        )

    def cells(self):
        top = " " + "__ " * self.c
        rows = "\n".join(
            "|" + "".join(f"_{self.char}|" if self._grid[y, x] else "__|"
                          for x in range(self.c))
            for y in range(self.r)
        )
        return top[:-1] + "\n" + rows

    def font0(self): return str(self)
    def font1(self): return self.cells()
    def font2(self): return self.cells().replace('|', '').replace('_', ' ')

    def _pad(self, pad_width):
        self._grid = np.pad(self._grid, pad_width, mode='constant')
        self.r, self.c = self._grid.shape

    def addrow_up(self, n):    self._pad(((n, 0), (0, 0)))
    def addrow_down(self, n):  self._pad(((0, n), (0, 0)))
    def addcolumn_left(self, n):  self._pad(((0, 0), (n, 0)))
    def addcolumn_right(self, n): self._pad(((0, 0), (0, n)))

    def addrow_ud(self, n):
        up = n // 2
        self.addrow_up(up)
        self.addrow_down(n - up)

    def addcolumn_rl(self, n):
        left = n // 2
        self.addcolumn_left(left)
        self.addcolumn_right(n - left)

    def copy(self):
        new = GridMap(self.r, self.c, char=self.char)
        new._grid = self._grid.copy()
        return new

    @classmethod
    def side_merge(cls, a, b, force_merge=False):
        a, b = a.copy(), b.copy()
        if a.r != b.r:
            if not force_merge: raise NotMergeableError("row mismatch")
            diff = abs(a.r - b.r)
            if a.r < b.r: a.addrow_ud(diff)
            else:         b.addrow_ud(diff)
        res = cls(a.r, a.c + b.c, char=a.char)
        res._grid[:, :a.c] = a._grid
        res._grid[:, a.c:] = b._grid
        return res

    @classmethod
    def bottom_merge(cls, a, b, force_merge=False):
        a, b = a.copy(), b.copy()
        if a.c != b.c:
            if not force_merge: raise NotMergeableError("col mismatch")
            diff = abs(a.c - b.c)
            if a.c < b.c: a.addcolumn_rl(diff)
            else:         b.addcolumn_rl(diff)
        res = cls(a.r + b.r, a.c, char=a.char)
        res._grid[:a.r, :] = a._grid
        res._grid[a.r:, :] = b._grid
        return res

    def __add__(self, other):
        return self.side_merge(self, other)

    @classmethod
    def animate(cls, frames, *, r=None, c=None, time_delay=0.08,
                style=0, clear=True, max_loops=None):
        # auto-size if not given
        if r is None:
            r = max(p[0] for f in frames for p in f) + 1
        if c is None:
            c = max(p[1] for f in frames for p in f) + 1

        canvas = cls(r, c)
        render = [canvas.font0, canvas.font1, canvas.font2][style]

        rendered = []
        for pts in frames:
            canvas.plots = pts
            rendered.append(render())

        sys.stdout.write("\033[?25l")
        sys.stdout.flush()

        loops = float('inf') if max_loops is None else max_loops
        i = 0
        try:
            while i < loops:
                for s in rendered:
                    if clear:
                        sys.stdout.write("\033[H\033[2J")
                    sys.stdout.write(s)
                    sys.stdout.flush()
                    sleep(time_delay)
                    i += 1
        finally:
            sys.stdout.write("\033[?25h\033[H")
            sys.stdout.flush()

    @classmethod
    def str_to_gm(cls, s: str, force_merge=True):
        lines = [ln for ln in s.split("\n") if ln.strip()]
        if len(lines) == 1:
            row = lines[0]
            gm = cls(*cls.BASE_DICT[row[0]])
            for ch in row[1:]:
                gm = cls.side_merge(gm, cls(*cls.BASE_DICT[ch]), force_merge)
            return gm
        else:
            gms = [cls.str_to_gm(ln, force_merge) for ln in lines]
            res = gms[0]
            for g in gms[1:]:
                res = cls.bottom_merge(res, g, force_merge)
            return res

if __name__ == "__main__":
    # Game of Life
    try:
        ROWS, COLS = int(sys.argv[1]), int(sys.argv[2])
    except:
        ROWS, COLS = 35, 35

    # Random start
    grid = np.random.rand(ROWS, COLS) < 0.3

    frames = []
    for _ in range(400):
        y, x = np.where(grid)
        frames.append(list(zip(y, x)))

        # Count neighbors (fast)
        n = sum(np.roll(np.roll(grid, dy, 0), dx, 1)
                for dy in (-1,0,1) for dx in (-1,0,1) if (dy,dx) != (0,0))
        grid = (n == 3) | (grid & (n == 2))

    GridMap.animate(
        frames,
        r=ROWS,
        c=COLS,
        time_delay=0.10,
        style=2,
        clear=True
    )
